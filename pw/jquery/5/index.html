<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
		<style>
			ol#carousel {
				position: relative;
				padding: 0;
				margin-left: 20px;
			} ol#carousel > li { position: absolute;
				top: 0;
				left: 0;
				opacity: 0;
				transition: opacity 1s;
				z-index: -1000;
			}
			ol#carousel > li.visible {
				position: static;
				opacity: 1;
			}
		</style>
	</head>
	<body>
		<ol id="carousel">
			<li class="visible">
				<img src="gfx/among-us-brown-toilet-paper-hat-png-01.png">
				<a href="https://www.youtube.com/watch?v=N_D-GW_3xvE">sussus amogus</a>
			</li>
			<li>
				<img src="gfx/among-us-green-dead-body-png-01.png">
				<a href="https://www.youtube.com/watch?v=3qT9gzaUTq0">imposterus magnificus</a>
			</li>
			<li>
				<img src="gfx/among-us-orange-egg-hat-png-01.png">
				<a href="https://www.youtube.com/watch?v=JPivVipz_P0">hocus pocus</a>
			</li>
			<li>
				<img src="gfx/among-us-red-png-01.png">
				<a href="https://www.youtube.com/watch?v=85aVEtikOGA">ventus obscurus</a>
			</li>
		</ol>
		<input type="button" value="Previous">
		<input type="button" value="Next">
	</body>
	<script>
		$("input[value=\"Previous\"]").click((event) => {
			carouselAddButton(-1);
		});
		$("input[value=\"Next\"]").click((event) => {
			carouselAddButton(1);
		});
		
		function carouselAdd(amount) {
			let carousel = $("#carousel");
			let visible = $("li.visible");

			let visibleIndex = carousel.children().index(visible);

			visibleIndex = (((visibleIndex+amount) % carousel.children().length) + carousel.children().length) % carousel.children().length;
			visible.removeClass("visible");
			$(carousel.children()[visibleIndex]).addClass("visible");
		}

		var cancelCarouselLoop = null;

		function carouselAddButton(amount) {
			if (cancelCarouselLoop !== null) {
				cancelCarouselLoop();
			}

			carouselAdd(amount);
		}

		async function loopCarousel() {
			while (true) {
				let cancel = false;
				
				await Promise.race([
					(new Promise(r => setTimeout(r, 5000)))
						.then(() => {
							if (!cancel) {
								carouselAdd(1);
							}
						}),
					new Promise((resolve, reject) => {
						cancelCarouselLoop = () => {
							resolve();
							cancel = true;
						};
					})
				]);
			}
		}

		loopCarousel();
	</script>
</html>
